# 健康記録アプリ開発計画

## 現在のゴール
**セッション内チャット履歴機能**: チャットページで複数回の送受信とAIが過去の会話を記憶する機能

## TODO リスト

### Phase 1: 基本UI
- [x] 入力フォーム表示（完了）
  - [x] Flask アプリケーションの基本構造
  - [x] HTMLページに大きなテキストエリアと送信ボタンを表示
  - [x] 基本的なCSSスタイリング

### Phase 2: データ保存
- [x] 記録保存機能
  - [x] ファイルシステムへの保存
  - [x] タイムスタンプ付きファイル名生成
  - [x] ディレクトリ構造作成
- [ ] 入力バリデーション
  - [ ] 空文字チェック
  - [ ] 文字数制限
  - [ ] 不正な文字の除去

### Phase 3: AIチャット機能
- [x] 基本Ollama連携
  - [x] HTTP API呼び出し
  - [x] 基本チャットインターフェース
- [x] 高度なチャット機能
  - [x] ペイロードのテスト追加
  - [x] システムプロンプトの実装（日本語指定）
  - [x] 過去の健康記録の文脈追加
  - [x] 期間指定UI（1週間、1ヶ月、3日など）
    - [x] HTMLフォームに期間選択（1週間、1ヶ月）
    - [x] デフォルトで1週間選択
  - [x] ファイルフィルタリング機能（キーワード検索）
    - [x] HTMLフォームにキーワード入力欄
    - [x] スペース区切り・コンマ区切り対応
    - [x] OR条件でのフィルタリング
  - [x] 記録データの読み込みと解析
    - [x] 期間フィルタリング実装
    - [x] キーワードフィルタリング実装
  - [x] チャットエンドポイントでフィルタリングパラメータ使用
  - [ ] セッション内チャット履歴
    - [ ] チャットページで複数回の送受信を可能にする
    - [ ] AIが同一セッション内の過去の会話を記憶
    - [ ] メッセージ送信後も過去の会話を画面に表示
  - [ ] 永続的チャット履歴
    - [ ] チャット内容をファイルとして保存
    - [ ] 過去のチャット履歴の閲覧機能
  - [ ] チャットメッセージの見やすいフォーマット表示

### Phase 4: ガイダンス機能
- [ ] 入力ガイダンス
  - [ ] 過去の記録パターン分析
  - [ ] サジェスト表示


## 完了済み
- [x] 要件書作成
- [x] アーキテクチャ設計書作成
- [x] .gitignore作成
- [x] requirements.txt作成
- [x] Flask基本アプリケーション（app.py）
- [x] 入力フォームHTML（templates/index.html）
- [x] 基本テストコード（test_app.py）
- [x] AIコンテキスト設定UI機能（詳細はPhase 3参照）